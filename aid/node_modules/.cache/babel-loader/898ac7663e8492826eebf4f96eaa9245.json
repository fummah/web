{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\")[\"default\"];\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\")[\"default\"];\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\nvar _padStart = _interopRequireDefault(require(\"lodash/padStart\"));\nvar _rcPicker = require(\"rc-picker\");\nvar _useMergedState5 = _interopRequireDefault(require(\"rc-util/lib/hooks/useMergedState\"));\nvar React = _interopRequireWildcard(require(\"react\"));\nvar _configProvider = require(\"../config-provider\");\nvar _LocaleReceiver = _interopRequireDefault(require(\"../locale-provider/LocaleReceiver\"));\nvar _Header = _interopRequireDefault(require(\"./Header\"));\nvar _en_US = _interopRequireDefault(require(\"./locale/en_US\"));\nfunction generateCalendar(generateConfig) {\n  function isSameYear(date1, date2) {\n    return date1 && date2 && generateConfig.getYear(date1) === generateConfig.getYear(date2);\n  }\n  function isSameMonth(date1, date2) {\n    return isSameYear(date1, date2) && generateConfig.getMonth(date1) === generateConfig.getMonth(date2);\n  }\n  function isSameDate(date1, date2) {\n    return isSameMonth(date1, date2) && generateConfig.getDate(date1) === generateConfig.getDate(date2);\n  }\n  var Calendar = function Calendar(props) {\n    var customizePrefixCls = props.prefixCls,\n      className = props.className,\n      style = props.style,\n      dateFullCellRender = props.dateFullCellRender,\n      dateCellRender = props.dateCellRender,\n      monthFullCellRender = props.monthFullCellRender,\n      monthCellRender = props.monthCellRender,\n      headerRender = props.headerRender,\n      value = props.value,\n      defaultValue = props.defaultValue,\n      disabledDate = props.disabledDate,\n      mode = props.mode,\n      validRange = props.validRange,\n      _props$fullscreen = props.fullscreen,\n      fullscreen = _props$fullscreen === void 0 ? true : _props$fullscreen,\n      onChange = props.onChange,\n      onPanelChange = props.onPanelChange,\n      onSelect = props.onSelect;\n    var _React$useContext = React.useContext(_configProvider.ConfigContext),\n      getPrefixCls = _React$useContext.getPrefixCls,\n      direction = _React$useContext.direction;\n    var prefixCls = getPrefixCls('picker', customizePrefixCls);\n    var calendarPrefixCls = \"\".concat(prefixCls, \"-calendar\");\n    var today = generateConfig.getNow();\n    // ====================== State =======================\n    // Value\n    var _useMergedState = (0, _useMergedState5[\"default\"])(function () {\n        return value || generateConfig.getNow();\n      }, {\n        defaultValue: defaultValue,\n        value: value\n      }),\n      _useMergedState2 = (0, _slicedToArray2[\"default\"])(_useMergedState, 2),\n      mergedValue = _useMergedState2[0],\n      setMergedValue = _useMergedState2[1];\n    // Mode\n    var _useMergedState3 = (0, _useMergedState5[\"default\"])('month', {\n        value: mode\n      }),\n      _useMergedState4 = (0, _slicedToArray2[\"default\"])(_useMergedState3, 2),\n      mergedMode = _useMergedState4[0],\n      setMergedMode = _useMergedState4[1];\n    var panelMode = React.useMemo(function () {\n      return mergedMode === 'year' ? 'month' : 'date';\n    }, [mergedMode]);\n    // Disabled Date\n    var mergedDisabledDate = React.useCallback(function (date) {\n      var notInRange = validRange ? generateConfig.isAfter(validRange[0], date) || generateConfig.isAfter(date, validRange[1]) : false;\n      return notInRange || !!(disabledDate === null || disabledDate === void 0 ? void 0 : disabledDate(date));\n    }, [disabledDate, validRange]);\n    // ====================== Events ======================\n    var triggerPanelChange = function triggerPanelChange(date, newMode) {\n      onPanelChange === null || onPanelChange === void 0 ? void 0 : onPanelChange(date, newMode);\n    };\n    var triggerChange = function triggerChange(date) {\n      setMergedValue(date);\n      if (!isSameDate(date, mergedValue)) {\n        // Trigger when month panel switch month\n        if (panelMode === 'date' && !isSameMonth(date, mergedValue) || panelMode === 'month' && !isSameYear(date, mergedValue)) {\n          triggerPanelChange(date, mergedMode);\n        }\n        onChange === null || onChange === void 0 ? void 0 : onChange(date);\n      }\n    };\n    var triggerModeChange = function triggerModeChange(newMode) {\n      setMergedMode(newMode);\n      triggerPanelChange(mergedValue, newMode);\n    };\n    var onInternalSelect = function onInternalSelect(date) {\n      triggerChange(date);\n      onSelect === null || onSelect === void 0 ? void 0 : onSelect(date);\n    };\n    // ====================== Locale ======================\n    var getDefaultLocale = function getDefaultLocale() {\n      var locale = props.locale;\n      var result = (0, _extends2[\"default\"])((0, _extends2[\"default\"])({}, _en_US[\"default\"]), locale);\n      result.lang = (0, _extends2[\"default\"])((0, _extends2[\"default\"])({}, result.lang), (locale || {}).lang);\n      return result;\n    };\n    // ====================== Render ======================\n    var dateRender = React.useCallback(function (date) {\n      if (dateFullCellRender) {\n        return dateFullCellRender(date);\n      }\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-cell-inner\"), \"\".concat(calendarPrefixCls, \"-date\"), (0, _defineProperty2[\"default\"])({}, \"\".concat(calendarPrefixCls, \"-date-today\"), isSameDate(today, date)))\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(calendarPrefixCls, \"-date-value\")\n      }, (0, _padStart[\"default\"])(String(generateConfig.getDate(date)), 2, '0')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(calendarPrefixCls, \"-date-content\")\n      }, dateCellRender && dateCellRender(date)));\n    }, [dateFullCellRender, dateCellRender]);\n    var monthRender = React.useCallback(function (date, locale) {\n      if (monthFullCellRender) {\n        return monthFullCellRender(date);\n      }\n      var months = locale.shortMonths || generateConfig.locale.getShortMonths(locale.locale);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: (0, _classnames[\"default\"])(\"\".concat(prefixCls, \"-cell-inner\"), \"\".concat(calendarPrefixCls, \"-date\"), (0, _defineProperty2[\"default\"])({}, \"\".concat(calendarPrefixCls, \"-date-today\"), isSameMonth(today, date)))\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(calendarPrefixCls, \"-date-value\")\n      }, months[generateConfig.getMonth(date)]), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\".concat(calendarPrefixCls, \"-date-content\")\n      }, monthCellRender && monthCellRender(date)));\n    }, [monthFullCellRender, monthCellRender]);\n    return /*#__PURE__*/React.createElement(_LocaleReceiver[\"default\"], {\n      componentName: \"Calendar\",\n      defaultLocale: getDefaultLocale\n    }, function (contextLocale) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: (0, _classnames[\"default\"])(calendarPrefixCls, (0, _defineProperty2[\"default\"])((0, _defineProperty2[\"default\"])((0, _defineProperty2[\"default\"])({}, \"\".concat(calendarPrefixCls, \"-full\"), fullscreen), \"\".concat(calendarPrefixCls, \"-mini\"), !fullscreen), \"\".concat(calendarPrefixCls, \"-rtl\"), direction === 'rtl'), className),\n        style: style\n      }, headerRender ? headerRender({\n        value: mergedValue,\n        type: mergedMode,\n        onChange: onInternalSelect,\n        onTypeChange: triggerModeChange\n      }) : ( /*#__PURE__*/React.createElement(_Header[\"default\"], {\n        prefixCls: calendarPrefixCls,\n        value: mergedValue,\n        generateConfig: generateConfig,\n        mode: mergedMode,\n        fullscreen: fullscreen,\n        locale: contextLocale.lang,\n        validRange: validRange,\n        onChange: onInternalSelect,\n        onModeChange: triggerModeChange\n      })), /*#__PURE__*/React.createElement(_rcPicker.PickerPanel, {\n        value: mergedValue,\n        prefixCls: prefixCls,\n        locale: contextLocale.lang,\n        generateConfig: generateConfig,\n        dateRender: dateRender,\n        monthCellRender: function monthCellRender(date) {\n          return monthRender(date, contextLocale.lang);\n        },\n        onSelect: onInternalSelect,\n        mode: panelMode,\n        picker: panelMode,\n        disabledDate: mergedDisabledDate,\n        hideHeader: true\n      }));\n    });\n  };\n  return Calendar;\n}\nvar _default = exports[\"default\"] = generateCalendar;","map":null,"metadata":{},"sourceType":"script"}